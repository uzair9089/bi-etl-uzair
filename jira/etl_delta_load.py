query = {

'issues':"drop table if exists issues_id; create temp table issues_id as select distinct issue_id from jira.issues where updated>=current_date-2;delete from stage.s_jira_issues where issue_id in (select issue_id from issues_id); insert into stage.s_jira_issues select * from (select *,row_number() over (partition by issue_id order by updated desc) as rnk from jira.issues where updated>=current_date-2) as t where rnk=1;"
,'issue_story_points':"drop table if exists issue_story_points_id; create temp table issue_story_points_id as select distinct issue_id from jira.issue_story_points where etl_date>=current_date-2;delete from stage.s_jira_issue_story_points where issue_id in (select issue_id from issue_story_points_id); insert into stage.s_jira_issue_story_points select * from (select *,row_number() over (partition by issue_id order by etl_date desc) as rnk from jira.issue_story_points where etl_date>=current_date-2) as t where rnk=1;"
#,'map_issues':"drop table if exists map_issues_id; create temp table map_issues_id as select distinct issue_id from jira.map_issues where etl_date>=current_date-2;delete from stage.s_jira_map_issues where issue_id in (select issue_id from map_issues_id); insert into stage.s_jira_map_issues select * from (select *,row_number() over (partition by issue_id order by etl_date desc) as rnk from jira.map_issues where etl_date>=current_date-2) as t where rnk=1;"
,'sprints':"drop table if exists sprints_id; create temp table sprints_id as select distinct issue_id from jira.sprints where etl_date>=current_date-2; delete from stage.s_jira_sprints where issue_id in (select issue_id from sprints_id); create temp table sprints as select * from (select *,row_number() over (partition by issue_id order by etl_date desc) as rnk from jira.sprints where etl_date>=current_date-2) as t where rnk=1;insert into stage.s_jira_sprints  select  issue_id,     sprint_info,to_timestamp(replace(substring(split_part(sprint_info, ',', 5),position('startDate=' in  split_part(sprint_info, ',', 5))+10),'<nul','2000-01-01T01:00:00:00') , 'YYYY/MM/DD hh24:mi:ss') AS sprint_start,      to_timestamp( replace(substring(split_part(sprint_info, ',', 6),position('endDate=' in  split_part(sprint_info, ',', 6))+8),'<nul','2000-01-01T01:00:00:00') , 'YYYY/MM/DD hh24:mi:ss') AS sprint_end,     substring(split_part(sprint_info, ',', 1),position('[id=' in  split_part(sprint_info, ',', 1))+4)::integer  AS sprint_num,  substring(split_part(sprint_info, ',', 3),position('state=' in  split_part(sprint_info, ',', 3))+6) AS state,       etl_date, rnk,substring(split_part(sprint_info, ',', 4),position('name=' in  split_part(sprint_info, ',', 4))+5) AS sprint_name,  substring(split_part(sprint_info, ',', 7),position('completeDate=' in  split_part(sprint_info, ',', 7))+13) AS complete_date  from  sprints where sprint_info not like '%N/A%';"
,'issues_history':"drop view prod.issues_history;drop table if exists stage.s_jira_issues_history; create table stage.s_jira_issues_history as select * from (select *,row_number() over (partition by issue_id, summary, priority, assignee, status, labels, created, updated, issuetype, creator,project_id, timeestimate, description,status_changed,history order by etl_date desc) as rnk from jira.issues_history ) as t where rnk=1;create view prod.issues_history as select * from stage.s_jira_issues_history;"
#as t where rnk=1
}